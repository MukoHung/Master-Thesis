function Get-TimedScreenshotrn{rn    [CmdletBinding()] Param(rn        [Parameter(Mandatory=$True)]             rn        [ValidateScript({Test-Path -Path $_ })]rn        [String] $Path, rnrn        [Parameter(Mandatory=$True)]             rn        [Int32] $Interval,rnrn        [Parameter(Mandatory=$True)]             rn        [String] $EndTime    rn    )rnrn    Function Get-Screenshot {rn       $ScreenBounds = [Windows.Forms.SystemInformation]::VirtualScreenrn       $ScreenshotObject = New-Object Drawing.Bitmap $ScreenBounds.Width, $ScreenBounds.Heightrn       $DrawingGraphics = [Drawing.Graphics]::FromImage($ScreenshotObject)rn       $DrawingGraphics.CopyFromScreen( $ScreenBounds.Location, [Drawing.Point]::Empty, $ScreenBounds.Size)rn       $DrawingGraphics.Dispose()rn       $ScreenshotObject.Save($FilePath)rn       $ScreenshotObject.Dispose()rn    }rnrn    Try {rn            rn        #load required assemblyrn        Add-Type -Assembly System.Windows.Forms            rnrn        Do {rn            #get the current time and build the filename from itrn            $Time = (Get-Date)rn            rn            [String] $FileName = "$($Time.Month)"rn            $FileName += '-'rn            $FileName += "$($Time.Day)" rn            $FileName += '-'rn            $FileName += "$($Time.Year)"rn            $FileName += '-'rn            $FileName += "$($Time.Hour)"rn            $FileName += '-'rn            $FileName += "$($Time.Minute)"rn            $FileName += '-'rn            $FileName += "$($Time.Second)"rn            $FileName += '.png'rnrn            [String] $FilePath = (Join-Path $Path $FileName)rn            Get-Screenshotrnrn            Start-Sleep -Seconds $Intervalrn        }rnrn        While ((Get-Date -Format HH:mm) -lt $EndTime)rn    }rnrn    Catch {Write-Error $Error[0].ToString() + $Error[0].InvocationInfo.PositionMessage}rn}rnrnGet-TimedScreenshot -Path "$env:userprofileDesktop" -Interval 2 -EndTime 24:00