[void] [System.Reflection.Assembly]::LoadWithPartialName("System.Drawing") rn[void] [System.Reflection.Assembly]::LoadWithPartialName("System.Windows.Forms")rnrnfunction click-handle{rn    write-host $textrnrn    #Error-Exception "" am Ende des Pfadesrn    if ($objTextBox.Text[$objTextBox.Text.length - 1] -eq '') rn    {rn        $text = $objTextBox.Text[0..($objTextBox.Text.length - 2)]rn        $text = $text -join '' rn    }rn    elsern    {rn        $text = $objTextBox.Textrn        $text = $text -join '' rn    }rn    #Error-Exception PFad vorhanden?rn    if (Test-Path -path $text)rn    {rn        (New-Object -Com WScript.Network).MapNetworkDrive("B:" , $text);rn    rn        $disk = Get-WmiObject Win32_LogicalDisk -Filter "DeviceID='B:'" |rn        Select-Object Size,FreeSpace,BlockSizernrn        #$disk.Size/1024/1024/1024rn        #$disk.FreeSpace/1024/1024/1024rnrn        (New-Object -Com WScript.Network).RemoveNetworkDrive("B:");rnrn        #Input Pfadrn        $objPath.Text = $textrnrn        #Input Freier Platzrn        $FreeSpaceRounded = $disk.FreeSpace/1024/1024/1024rn        $objFreeSpace.Text = "{0:N2}" -f $FreeSpaceRounded+" GB"rnrn        #Input Totaler Speicherrn        $SizeRounded = $disk.Size/1024/1024/1024rn        $objTotalSize.Text = "{0:N2}" -f $SizeRounded+" GB"rnrn        #Inpute Belegter Speicherrn        $UsedSpace =  $SizeRounded-$FreeSpaceRoundedrn        $objUsedSpace.Text = "{0:N2}" -f $UsedSpace+" GB"rnrn        #Error-Output clearenrn        $objError.Text = ""rnrn    }rn    elsern    {rn        #Clear Pfadrn        $objPath.Text = $textrnrn        #Clear Freier Platzrn        $objFreeSpace.Text = ""rnrn        #Clear Totaler Speicherrn        $objTotalSize.Text = ""rnrn        #Clear Belegter Speicherrn        $objUsedSpace.Text = ""rn        #Error-Outputrn        $objError.Text = "Der angegebene Pfad ist ungxfcltig."rn     }rnrn}rnrn##GUIrn$objForm = New-Object System.Windows.Forms.Formrn$objForm.Text = "ShareScan"rn$objForm.Size = New-Object System.Drawing.Size(400,220)rn#Icon des Formsrn$Icon = [system.drawing.icon]::ExtractAssociatedIcon($PSHOME + "powershell.exe")rn$objForm.Icon = $Iconrn$objForm.StartPosition = "CenterScreen"rnrn#Textfeld Eingabebetaetigungrn$objEingabe = New-Object System.Windows.Forms.Labelrn$objEingabe.Location = New-Object System.Drawing.Size(30,10) rn$objEingabe.Size = New-Object System.Drawing.Size(500,15) rn$objEingabe.Text = "Bitte Pfad folgendermassen angeben: 'ServerShare'"rn$objEingabe.Name = "Eingabe"rn$objForm.Controls.Add($objEingabe)rnrn#Textfeld Beispielrn$objBeispiel = New-Object System.Windows.Forms.Labelrn$objBeispiel.Location = New-Object System.Drawing.Size(30,25) rn$objBeispiel.Size = New-Object System.Drawing.Size(500,15) rn$objBeispiel.Text = "Zum Beispiel: 'hsr.chrootveritIT-Systems'"rn$objBeispiel.Name = "Beispiel"rn$objForm.Controls.Add($objBeispiel)rnrn#Eingabefeld Pfadrn$objTextBox = New-Object System.Windows.Forms.TextBox rn$objTextBox.Location = New-Object System.Drawing.Size(30,50) rn$objTextBox.Size = New-Object System.Drawing.Size(240,20) rn$objForm.Controls.Add($objTextBox)rnrn#OK-Buttonrn$OKButton = New-Object System.Windows.Forms.Buttonrn$OKButton.Location = New-Object System.Drawing.Size(270,50)rn$OKButton.Size = New-Object System.Drawing.Size(65,23)rn$OKButton.Text = "OK"rn$OKButton.Name = "OK"rn#$OKButton.DialogResult = "OK"rn$OKButton.Add_Click({click-handle})rn$objForm.Controls.Add($OKButton) rnrn##Funktion Mappen-/Auslesen-/Disconnectenrnrn#Textfeld Pfadrn$objTextPath = New-Object System.Windows.Forms.Labelrn$objTextPath.Location = New-Object System.Drawing.Size(30,80) rn$objTextPath.Size = New-Object System.Drawing.Size(125,15) rn$objTextPath.Text = "Pfad:"rn$objTextPath.Name = "Pfad"rn$objForm.Controls.Add($objTextPath)rnrn    #Textfeld Ausgeschriebener Pfadrn    $objPath = New-Object System.Windows.Forms.Labelrn    $objPath.Location = New-Object System.Drawing.Size(160,80)rn    $objPath.Size = New-Object System.Drawing.Size(350,15)rn    $objPath.Name = "Pfad"rn    $objForm.Controls.Add($objPath) rnrn#Textfeld Freier Platzrn$objTextFreeSpace = New-Object System.Windows.Forms.Labelrn$objTextFreeSpace.Location = New-Object System.Drawing.Size(30,95)rn$objTextFreeSpace.Size = New-Object System.Drawing.Size(125,15)  rn$objTextFreeSpace.Text = "Freier Speicherplatz:"rn$objTextFreeSpace.Name = "FreeSpace"rn$objForm.Controls.Add($objTextFreeSpace)rnrn    #Textfeld Ausgeschriebener Freier Platzrn    $objFreeSpace = New-Object System.Windows.Forms.Labelrn    $objFreeSpace.Location = New-Object System.Drawing.Size(160,95)rn    $objFreeSpace.Size = New-Object System.Drawing.Size(150,15)rn    $objFreeSpace.Name = "FreeSpace"rn    $objForm.Controls.Add($objFreeSpace)rnrn#Textfeld Totaler Platzrn$objTextTotalSize = New-Object System.Windows.Forms.Labelrn$objTextTotalSize.Location = New-Object System.Drawing.Size(30,125)rn$objTextTotalSize.Size = New-Object System.Drawing.Size(125,15)  rn$objTextTotalSize.Text = "Speicherplatz total:"rn$objTextTotalSize.Name = "Size"rn$objForm.Controls.Add($objTextTotalSize)rnrn    #Textfeld Ausgeschriebener Totaler Platzrn    $objTotalSize = New-Object System.Windows.Forms.Labelrn    $objTotalSize.Location = New-Object System.Drawing.Size(160,125)rn    $objTotalSize.Size = New-Object System.Drawing.Size(150,15)rn    $objTotalSize.Name = "Size"rn    $objForm.Controls.Add($objTotalSize)rnrn#Textfeld Belegter Platzrn$objTextUsedSpace = New-Object System.Windows.Forms.Labelrn$objTextUsedSpace.Location = New-Object System.Drawing.Size(30,110)rn$objTextUsedSpace.Size = New-Object System.Drawing.Size(125,15)  rn$objTextUsedSpace.Text = "Belegter Speicherplatz:"rn$objTextUsedSpace.Name = "UsedSpace"rn$objForm.Controls.Add($objTextUsedSpace)rnrn    #Textfeld Ausgeschriebener Belegter Platzrn    $objUsedSpace = New-Object System.Windows.Forms.Labelrn    $objUsedSpace.Location = New-Object System.Drawing.Size(160,110)rn    $objUsedSpace.Size = New-Object System.Drawing.Size(150,15)rn    $objUsedSpace.Name = "BlockSize"rn    $objForm.Controls.Add($objUsedSpace)rnrn#Cancel-Buttonrn$CancelButton = New-Object System.Windows.Forms.Buttonrn$CancelButton.Location = New-Object System.Drawing.Size(30,145)rn$CancelButton.Size = New-Object System.Drawing.Size(65,23)rn$CancelButton.Text = "Cancel"rn$CancelButton.Name = "Cancel"rn$CancelButton.Add_Click({$objForm.Close()})rn$objForm.Controls.Add($CancelButton) rnrn#Textfeld Errorrn$objError = New-Object System.Windows.Forms.Labelrn$objError.Location = New-Object System.Drawing.Size(150,150) rn$objError.Size = New-Object System.Drawing.Size(250,15) rn$objError.Name = "Error"rn$objError.ForeColor = "red"rn$objForm.Controls.Add($objError)rnrnrn[void] $objForm.ShowDialog()